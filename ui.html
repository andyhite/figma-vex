<!DOCTYPE html>
<html>
<head>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 12px;
      color: #333;
      padding: 16px;
      background: #fff;
    }

    h2 {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #000;
    }

    h3 {
      font-size: 12px;
      font-weight: 600;
      margin: 16px 0 8px;
      color: #333;
    }

    .tabs {
      display: flex;
      gap: 0;
      margin-bottom: 16px;
      border-bottom: 1px solid #e5e5e5;
    }

    .tab {
      padding: 8px 16px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      color: #666;
      border-bottom: 2px solid transparent;
      margin-bottom: -1px;
    }

    .tab:hover {
      color: #333;
    }

    .tab.active {
      color: #18a0fb;
      border-bottom-color: #18a0fb;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .form-group {
      margin-bottom: 12px;
    }

    label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      margin-bottom: 6px;
    }

    label.text-label {
      display: block;
      margin-bottom: 4px;
      font-weight: 500;
    }

    input[type="checkbox"] {
      width: 14px;
      height: 14px;
      cursor: pointer;
    }

    input[type="text"] {
      width: 100%;
      padding: 8px;
      border: 1px solid #e5e5e5;
      border-radius: 4px;
      font-size: 12px;
      font-family: 'SF Mono', Monaco, 'Courier New', monospace;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #18a0fb;
    }

    .output-area {
      width: 100%;
      height: 200px;
      padding: 12px;
      border: 1px solid #e5e5e5;
      border-radius: 4px;
      font-family: 'SF Mono', Monaco, 'Courier New', monospace;
      font-size: 11px;
      line-height: 1.5;
      resize: vertical;
      background: #fafafa;
    }

    .output-area:focus {
      outline: none;
      border-color: #18a0fb;
    }

    .button-row {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    button {
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .btn-primary {
      background: #18a0fb;
      color: #fff;
      border: none;
    }

    .btn-primary:hover {
      background: #0d8de5;
    }

    .btn-secondary {
      background: #fff;
      color: #333;
      border: 1px solid #e5e5e5;
    }

    .btn-secondary:hover {
      background: #f5f5f5;
    }

    .btn-success {
      background: #1bc47d;
      color: #fff;
      border: none;
    }

    .help-section {
      margin-top: 20px;
      padding: 12px;
      background: #f5f5f5;
      border-radius: 6px;
    }

    .help-section h4 {
      font-size: 11px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .help-section code {
      display: inline-block;
      background: #e5e5e5;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'SF Mono', Monaco, 'Courier New', monospace;
      font-size: 10px;
    }

    .help-section ul {
      list-style: none;
      font-size: 11px;
      color: #666;
    }

    .help-section li {
      margin-bottom: 4px;
    }

    .status {
      margin-top: 8px;
      font-size: 11px;
      color: #666;
    }

    .status.success {
      color: #1bc47d;
    }

    .status.error {
      color: #f24822;
    }
  </style>
</head>
<body>
  <h2>Variables Export</h2>

  <div class="tabs">
    <button class="tab active" data-tab="css">CSS</button>
    <button class="tab" data-tab="json">JSON</button>
    <button class="tab" data-tab="help">Help</button>
  </div>

  <div id="css-tab" class="tab-content active">
    <h3>Options</h3>

    <div class="form-group">
      <label class="text-label">CSS Selector</label>
      <input type="text" id="selector" value=":root" />
    </div>

    <div class="form-group">
      <label>
        <input type="checkbox" id="useModesAsSelectors" />
        Export modes as separate selectors
      </label>
    </div>

    <div class="form-group">
      <label>
        <input type="checkbox" id="includeCollectionComments" checked />
        Include collection comments
      </label>
    </div>

    <div class="form-group">
      <label>
        <input type="checkbox" id="includeModeComments" checked />
        Include mode comments
      </label>
    </div>

    <div class="button-row">
      <button class="btn-primary" id="export-css">Generate CSS</button>
    </div>

    <h3>Output</h3>
    <textarea class="output-area" id="css-output" readonly placeholder="Click 'Generate CSS' to export variables..."></textarea>

    <div class="button-row">
      <button class="btn-secondary" id="copy-css">Copy to Clipboard</button>
    </div>

    <div class="status" id="css-status"></div>
  </div>

  <div id="json-tab" class="tab-content">
    <p style="margin-bottom: 12px; color: #666;">
      Export as JSON for use with Style Dictionary or other token tools.
    </p>

    <div class="button-row">
      <button class="btn-primary" id="export-json">Generate JSON</button>
    </div>

    <h3>Output</h3>
    <textarea class="output-area" id="json-output" readonly placeholder="Click 'Generate JSON' to export variables..."></textarea>

    <div class="button-row">
      <button class="btn-secondary" id="copy-json">Copy to Clipboard</button>
    </div>

    <div class="status" id="json-status"></div>
  </div>

  <div id="help-tab" class="tab-content">
    <div class="help-section">
      <h4>Description Field Format</h4>
      <p style="margin-bottom: 12px; color: #666;">
        Add these instructions to any variable's description field to control export:
      </p>

      <h4 style="margin-top: 12px;">Number Units</h4>
      <ul>
        <li><code>unit: none</code> — Output raw number (e.g., 1.5 for line-height)</li>
        <li><code>unit: px</code> — Output with px (default)</li>
        <li><code>unit: rem</code> — Convert to rem (16px base)</li>
        <li><code>unit: rem:20</code> — Convert to rem with custom base</li>
        <li><code>unit: em</code> — Output with em</li>
        <li><code>unit: %</code> — Output as percentage</li>
        <li><code>unit: ms</code> — Output with ms</li>
      </ul>

      <h4 style="margin-top: 12px;">Color Formats</h4>
      <ul>
        <li><code>format: hex</code> — #rrggbb (default)</li>
        <li><code>format: rgb</code> — rgb(r, g, b)</li>
        <li><code>format: rgba</code> — rgba(r, g, b, a)</li>
        <li><code>format: hsl</code> — hsl(h, s%, l%)</li>
        <li><code>format: oklch</code> — oklch(l% c h)</li>
      </ul>

      <h4 style="margin-top: 12px;">Examples</h4>
      <ul>
        <li>Line height: Add <code>unit: none</code> → outputs <code>1.5</code></li>
        <li>Font weight: Add <code>unit: none</code> → outputs <code>700</code></li>
        <li>Z-index: Add <code>unit: none</code> → outputs <code>100</code></li>
        <li>Spacing: Add <code>unit: rem</code> → outputs <code>1rem</code></li>
      </ul>
    </div>
  </div>

  <script>
    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

        tab.classList.add('active');
        document.getElementById(tab.dataset.tab + '-tab').classList.add('active');
      });
    });

    // Export CSS
    document.getElementById('export-css').addEventListener('click', () => {
      const options = {
        selector: document.getElementById('selector').value || ':root',
        useModesAsSelectors: document.getElementById('useModesAsSelectors').checked,
        includeCollectionComments: document.getElementById('includeCollectionComments').checked,
        includeModeComments: document.getElementById('includeModeComments').checked,
      };

      parent.postMessage({ pluginMessage: { type: 'export-css', options } }, '*');
      document.getElementById('css-status').textContent = 'Generating...';
      document.getElementById('css-status').className = 'status';
    });

    // Export JSON
    document.getElementById('export-json').addEventListener('click', () => {
      parent.postMessage({ pluginMessage: { type: 'export-json' } }, '*');
      document.getElementById('json-status').textContent = 'Generating...';
      document.getElementById('json-status').className = 'status';
    });

    // Copy buttons
    document.getElementById('copy-css').addEventListener('click', () => {
      const output = document.getElementById('css-output');
      output.select();
      document.execCommand('copy');

      const status = document.getElementById('css-status');
      status.textContent = 'Copied to clipboard!';
      status.className = 'status success';
    });

    document.getElementById('copy-json').addEventListener('click', () => {
      const output = document.getElementById('json-output');
      output.select();
      document.execCommand('copy');

      const status = document.getElementById('json-status');
      status.textContent = 'Copied to clipboard!';
      status.className = 'status success';
    });

    // Receive messages from plugin
    window.onmessage = (event) => {
      const msg = event.data.pluginMessage;

      if (msg.type === 'css-result') {
        document.getElementById('css-output').value = msg.css;
        document.getElementById('css-status').textContent = 'Generated successfully!';
        document.getElementById('css-status').className = 'status success';
      }

      if (msg.type === 'json-result') {
        document.getElementById('json-output').value = msg.json;
        document.getElementById('json-status').textContent = 'Generated successfully!';
        document.getElementById('json-status').className = 'status success';
      }
    };
  </script>
</body>
</html>
